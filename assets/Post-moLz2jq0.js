import{r as a,F as k,u as N,j as e}from"./index-DfvjauYB.js";import{g as R}from"./localeStorageApi-BzC0sAnb.js";import{b as w}from"./registerAndLogin-srQY7G39.js";import{L as B}from"./Spinner-H4PWep4V.js";import"./firebase-CLNeqrfC.js";function F(s){const n=document.createElement("div");return n.textContent=s,n.innerHTML}const S="_postFormContainer_19kdp_3",U="_postForm_19kdp_3",M="_avatar_19kdp_43",P="_formContent_19kdp_57",y="_textarea_19kdp_71",I="_mediaPreview_19kdp_93",L="_footer_19kdp_117",E="_mediaButton_19kdp_133",z="_button_19kdp_161",A="_removeButton_19kdp_191",t={postFormContainer:S,postForm:U,avatar:M,formContent:P,textarea:y,mediaPreview:I,footer:L,mediaButton:E,button:z,removeButton:A};function J(){const[s,n]=a.useState(null),[d,g]=a.useState(null),l=a.useRef(null),i=a.useRef(null),{formData:f}=a.useContext(k),[_,p]=a.useState(!1),v=N(),[m,x]=a.useState({});a.useEffect(()=>{const c=JSON.parse(R());x(c)},[]);const h=c=>{const r=c.target.files[0],o=5;if(r){if(!/^image\/[a-zA-Z0-9.+-]+$/.test(r.type)){alert("Please, upload only images!");return}if(r.size>o*1024*1024){alert("Your file is too big! Max size: 5MB.");return}const C=URL.createObjectURL(r);n(r),g(C)}},j=()=>{n(null),i.current&&(i.current.value="")},b=async c=>{c.preventDefault();const r=l.current.value.trim(),o=F(r);if(!o||o.length<3){alert("üëâ Please enter at least 3 characters.");return}if(o.length>500){alert("üëâ The post cannot exceed 500 characters.");return}p(!0);const u={content:o,feedback:{comments:0,likes:0,views:0},img:s,meta:{author:f.name,date:new Date().toLocaleString(),avatar:"https://png.pngtree.com/png-clipart/20210915/ourmid/pngtree-user-avatar-placeholder-png-image_3918418.jpg",profileImg:m.profileImg?m.profileImg:"https://png.pngtree.com/png-clipart/20210915/ourmid/pngtree-user-avatar-placeholder-png-image_3918418.jpg"},comments:[]};await w(u),l.current.value="",n(null),i.current&&(i.current.value=""),v("/react-regular-exam/welcome"),p(!1)};return e.jsxs("div",{className:t.postFormContainer,children:[_&&e.jsx(B,{}),e.jsxs("div",{className:t.postForm,children:[e.jsx("img",{src:m.profileImg||"https://png.pngtree.com/png-clipart/20210915/ourmid/pngtree-user-avatar-placeholder-png-image_3918418.jpg",alt:"User avatar",className:t.avatar}),e.jsxs("form",{onSubmit:b,className:t.formContent,children:[e.jsx("textarea",{ref:l,placeholder:"What's happening?",className:t.textarea}),s&&e.jsx("div",{className:t.mediaPreview,children:e.jsx("img",{src:d,alt:"Uploaded media preview"})}),e.jsxs("div",{className:t.footer,children:[e.jsxs("label",{className:t.mediaButton,children:["üì∑ Add Media",e.jsx("input",{type:"file",accept:"image/*",onChange:h,hidden:!0,ref:i})]}),s&&e.jsx("button",{type:"button",onClick:j,className:t.removeButton,children:"‚ùå Remove"}),e.jsx("button",{type:"submit",className:t.button,children:"Post"})]})]})]})]})}export{J as default};
